local EXPLOIT_DESTROYER_SETTINGS = {
    COUNT = 4
}

local loki_list = {
    "pplay_deleterow", "pplay_addrow", "pplay_sendtable", "WriteQuery", 
    "VJSay", "SendMoney", "BailOut", "customprinter_get", 
    "textstickers_entdata", "NC_GetNameChange", "ATS_WARP_REMOVE_CLIENT", 
    "ATS_WARP_FROM_CLIENT", "ATS_WARP_VIEWOWNER", "CFRemoveGame", 
    "CFJoinGame", "CFEndGame", "Keypad", "CreateCase", 
    "rprotect_terminal_settings", "StackGhost", "RevivePlayer", 
    "ARMORY_RetrieveWeapon", "TransferReport", "SimplicityAC_aysent", 
    "pac_to_contraption", "SyncPrinterButtons76561198056171650", 
    "sendtable", "steamid2", "properties"
}

local string_format = string.format
local net_Receive = net.Receive
local math_random = math.random
local util_NetworkStringToID = util.NetworkStringToID
local table_remove = table.remove
local util_AddNetworkString = util.AddNetworkString
local timer_Simple = timer.Simple

local ban = function(len, ply)
    ply:Ban(0, false)
    ply:Kick("No Exploits!")
end

timer_Simple(1, function() 
    for i = #loki_list, 1, -1 do
        if (util_NetworkStringToID(loki_list, i) ~= 0) then
            print(string_format("%s has been detected - be sure it's not exploitable", table_remove(loki_list, i)))
        end
    end
    for i = 1, EXPLOIT_DESTROYER_SETTINGS.COUNT do 
        local rand = table_remove(loki_list, math_random(1, #loki_list))
        if (not rand) then
            print "couldn't find unallocated loki netstring"
            break
        end
        util_AddNetworkString(rand)
        net_Receive(rand, ban)
        print(string_format("%s has been allocated to ban", rand))
    end
end)
